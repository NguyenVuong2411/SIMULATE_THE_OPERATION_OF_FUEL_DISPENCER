#include <hello.h>

char *SSID="Thuy";                  //your wifi
char *PASS="0908377688";                //your wifi
char *WEBSITE="vuongnguyen2411.infinityfreeapp.com";  //your web
 
/***************************************************************/
#INT_RDA
void  RDA_isr(void) 
{
unsigned char c; 
     c=getc();//Gan ki tu vua nhan duoc vao bien tam 
     //---------bat ki tu bat--------//
     if(c=='b')
        {
          c=getc();
          if(c=='a')
          {
            c=getc();
            if(c=='t')output_low(PIN_B1); //ON
          }
        }
    
     //---------bat ki tu tat--------//
}
void ESP8266_init()
{
 printf("AT\r\n");delay_ms(500);
 printf("ATE0\r\n");delay_ms(500);
 printf("AT+CWMODE=1\r\n");delay_ms(500);
 printf("AT+CWJAP=\"%s\",\"%s\"\r\n",SSID,PASS);delay_ms(4000); // thay mat khau va tai khoan tuong ung
 printf("AT+CIPMUX=0\r\n");delay_ms(500);
}
void GET_StatusLED()
{
  int length; 
  char data[90];
  sprintf(data,"GET /kiemtra.php HTTP/1.1\r\nHost:vuongnguyen2411.infinityfreeapp.com\r\n\r\n");
  printf("AT+CIPSTART=\"TCP\",\"%s\",80\r\n",WEBSITE);delay_ms(2000);  //wait connect
  length=sizeof(data);
  printf("AT+CIPSEND=%i\r\n",length);delay_ms(500);
  printf(data);delay_ms(1000);
  printf("AT+CIPCLOSE\r\n");delay_ms(200);
}
void uart()
{
   delay_ms(200);
   ESP8266_init();
   enable_interrupts(INT_RDA);
   
   GET_StatusLED();
   
}
